# C++ 数组知识点详解

## 📦 数组概述
数组是相同类型元素的集合，存储在**连续内存**中。通过索引访问元素（索引从0开始）。

## 1. 一维数组

### 1.1 定义与初始化
```cpp
// 定义方式
数据类型 数组名[数组长度];
数据类型 数组名[数组长度] = {值1, 值2, ...};
数据类型 数组名[] = {值1, 值2, ...}; // 自动推断长度

// 示例
int nums[5];               // 未初始化
double scores[3] = {92.5, 88.0, 95.5};
char vowels[] = {'a', 'e', 'i', 'o', 'u'}; // 自动推断长度为5
```

### 1.2 访问与操作
```cpp
// 索引访问
scores[0] = 90.0;  // 修改第一个元素
cout << vowels[2]; // 输出: i

// 遍历数组
int numbers[] = {10, 20, 30, 40, 50};
for (int i = 0; i < 5; i++) {
    cout << numbers[i] << " ";
}
// 输出: 10 20 30 40 50

// 范围循环(C++11)
for (int num : numbers) {
    cout << num << " ";
}
```

### 1.3 数组长度计算
```cpp
int arr[] = {1, 2, 3, 4, 5};
int length = sizeof(arr) / sizeof(arr[0]); // 计算元素个数
cout << "数组长度: " << length; // 输出: 5
```

### 1.4 数组与函数
```cpp
// 函数参数传递（数组会退化为指针）
void printArray(int arr[], int size) {
    for (int i = 0; i < size; i++) {
        cout << arr[i] << " ";
    }
}

int main() {
    int data[] = {2, 4, 6, 8, 10};
    printArray(data, 5); // 输出: 2 4 6 8 10
    return 0;
}
```

### 1.5 应用案例
```cpp
// 案例1：查找最大值
int findMax(int arr[], int size) {
    int maxVal = arr[0];
    for (int i = 1; i < size; i++) {
        if (arr[i] > maxVal) {
            maxVal = arr[i];
        }
    }
    return maxVal;
}

// 案例2：数组反转
void reverseArray(int arr[], int size) {
    for (int i = 0; i < size/2; i++) {
        int temp = arr[i];
        arr[i] = arr[size-1-i];
        arr[size-1-i] = temp;
    }
}

// 案例3：斐波那契数列
int fib[20];
fib[0] = 0; fib[1] = 1;
for (int i = 2; i < 20; i++) {
    fib[i] = fib[i-1] + fib[i-2];
}
```

## 2. 二维数组

### 2.1 定义与初始化
```cpp
// 定义方式
数据类型 数组名[行数][列数];
数据类型 数组名[行数][列数] = {
    {值11, 值12, ...},
    {值21, 值22, ...},
    ...
};

// 示例
int matrix[3][3]; // 3x3未初始化矩阵
double temps[2][4] = {
    {22.5, 23.0, 22.8, 23.1},
    {21.7, 22.3, 21.9, 22.5}
};
char tictactoe[][3] = { // 自动推断行数
    {'X', 'O', 'X'},
    {'O', 'X', 'O'},
    {'X', 'O', ' '}
};
```

### 2.2 访问与操作
```cpp
// 索引访问
temps[0][1] = 23.5;  // 修改第一行第二列元素
cout << tictactoe[2][2]; // 输出: ' '

// 嵌套循环遍历
for (int i = 0; i < 3; i++) {
    for (int j = 0; j < 3; j++) {
        cout << tictactoe[i][j] << " ";
    }
    cout << endl; // 换行
}
/* 输出:
X O X 
O X O 
X O   
*/
```

### 2.3 内存布局
- 二维数组在内存中按**行优先**顺序存储
- 实际是"数组的数组"

```cpp
int grid[2][3] = {{1,2,3}, {4,5,6}};
// 内存布局: [1][2][3][4][5][6]
```

### 2.4 数组与函数
```cpp
// 函数参数必须指定列数
void printMatrix(int mat[][3], int rows) {
    for (int i = 0; i < rows; i++) {
        for (int j = 0; j < 3; j++) {
            cout << mat[i][j] << " ";
        }
        cout << endl;
    }
}

int main() {
    int matrix[2][3] = {{1,2,3}, {4,5,6}};
    printMatrix(matrix, 2);
    return 0;
}
```

### 2.5 应用案例
```cpp
// 案例1：矩阵转置
void transpose(int mat[][3], int rows) {
    for (int i = 0; i < rows; i++) {
        for (int j = i+1; j < 3; j++) {
            // 交换元素
            int temp = mat[i][j];
            mat[i][j] = mat[j][i];
            mat[j][i] = temp;
        }
    }
}

// 案例2：矩阵乘法
void matrixMultiply(int a[][2], int b[][3], int result[][3], int rows) {
    for (int i = 0; i < rows; i++) {
        for (int j = 0; j < 3; j++) {
            result[i][j] = 0;
            for (int k = 0; k < 2; k++) {
                result[i][j] += a[i][k] * b[k][j];
            }
        }
    }
}

// 案例3：学生成绩表
const int STUDENTS = 3;
const int SUBJECTS = 4;
double grades[STUDENTS][SUBJECTS] = {
    {85, 92, 78, 90},
    {76, 88, 95, 82},
    {90, 85, 88, 92}
};

// 计算每个学生平均分
for (int i = 0; i < STUDENTS; i++) {
    double sum = 0;
    for (int j = 0; j < SUBJECTS; j++) {
        sum += grades[i][j];
    }
    cout << "学生" << i+1 << "平均分: " << sum/SUBJECTS << endl;
}
```

## ⚠️ 数组使用注意事项

### 1. 数组越界
```cpp
int arr[5] = {1,2,3,4,5};
cout << arr[5]; // 错误！索引范围是0-4
// 可能导致程序崩溃或不可预测行为
```

### 2. 数组大小必须为常量
```cpp
int size;
cin >> size;
// int dynamicArr[size]; // 错误！C++数组大小必须是常量
```

### 3. 数组名是首元素地址
```cpp
int arr[3] = {10,20,30};
int* ptr = arr; // 等价于 &arr[0]
cout << *ptr;   // 输出: 10
```

### 4. 数组不能直接赋值
```cpp
int a[3] = {1,2,3};
int b[3];
// b = a; // 错误！数组不能直接赋值
```

## 🔄 数组与指针关系

| 表达式 | 值 | 类型 |
|--------|-----|------|
| `arr` | 数组首地址 | `int*` |
| `arr[i]` | 第i个元素值 | `int` |
| `&arr[i]` | 第i个元素地址 | `int*` |
| `arr+1` | 第二个元素地址 | `int*` |
| `*(arr+1)` | 第二个元素值 | `int` |

```cpp
int nums[] = {10,20,30};
cout << nums[1] << endl;    // 20
cout << *(nums+1) << endl;  // 20 (指针运算)
cout << *(nums+2) << endl;  // 30
```

## 🆚 数组与向量(vector)对比

| 特性 | 数组 | vector |
|------|------|--------|
| **大小** | 固定 | 动态可变 |
| **内存** | 栈/静态区 | 堆内存 |
| **传递** | 退化为指针 | 值/引用传递 |
| **安全** | 易越界 | 边界检查 |
| **功能** | 基本操作 | 丰富方法 |
| **用法** | `int arr[5]` | `vector<int> v(5)` |

```cpp
// vector示例
#include <vector>
vector<int> vec = {1,2,3,4,5};
vec.push_back(6);  // 动态添加元素
cout << vec.size(); // 输出: 6
```

## 📊 综合应用案例

### 案例1：冒泡排序
```cpp
void bubbleSort(int arr[], int n) {
    for (int i = 0; i < n-1; i++) {
        for (int j = 0; j < n-i-1; j++) {
            if (arr[j] > arr[j+1]) {
                // 交换元素
                int temp = arr[j];
                arr[j] = arr[j+1];
                arr[j+1] = temp;
            }
        }
    }
}

int main() {
    int data[] = {64, 34, 25, 12, 22, 11, 90};
    int n = sizeof(data)/sizeof(data[0]);
    
    bubbleSort(data, n);
    
    cout << "排序后: ";
    for (int i = 0; i < n; i++) {
        cout << data[i] << " ";
    }
    // 输出: 11 12 22 25 34 64 90
    return 0;
}
```

### 案例2：矩阵运算
```cpp
const int ROWS = 2, COLS = 3;

// 矩阵加法
void addMatrices(int a[][COLS], int b[][COLS], int result[][COLS]) {
    for (int i = 0; i < ROWS; i++) {
        for (int j = 0; j < COLS; j++) {
            result[i][j] = a[i][j] + b[i][j];
        }
    }
}

int main() {
    int matA[ROWS][COLS] = {{1,2,3}, {4,5,6}};
    int matB[ROWS][COLS] = {{6,5,4}, {3,2,1}};
    int sum[ROWS][COLS];
    
    addMatrices(matA, matB, sum);
    
    cout << "矩阵和:\n";
    for (int i = 0; i < ROWS; i++) {
        for (int j = 0; j < COLS; j++) {
            cout << sum[i][j] << "\t";
        }
        cout << endl;
    }
    /* 输出:
    7   7   7
    7   7   7 */
    return 0;
}
```

### 案例3：井字棋游戏
```cpp
const int SIZE = 3;
char board[SIZE][SIZE] = {
    {' ', ' ', ' '},
    {' ', ' ', ' '},
    {' ', ' ', ' '}
};

void printBoard() {
    for (int i = 0; i < SIZE; i++) {
        cout << " " << board[i][0] << " | " << board[i][1] << " | " << board[i][2] << endl;
        if (i < SIZE-1) cout << "---|---|---" << endl;
    }
}

bool checkWin(char player) {
    // 检查行
    for (int i = 0; i < SIZE; i++) {
        if (board[i][0] == player && board[i][1] == player && board[i][2] == player)
            return true;
    }
    // 检查列
    for (int j = 0; j < SIZE; j++) {
        if (board[0][j] == player && board[1][j] == player && board[2][j] == player)
            return true;
    }
    // 检查对角线
    if (board[0][0] == player && board[1][1] == player && board[2][2] == player)
        return true;
    if (board[0][2] == player && board[1][1] == player && board[2][0] == player)
        return true;
    return false;
}

int main() {
    // 简化的游戏循环
    board[0][0] = 'X'; board[0][1] = 'O'; board[0][2] = 'X';
    board[1][0] = 'O'; board[1][1] = 'X'; board[1][2] = 'O';
    board[2][0] = 'X'; board[2][1] = ' '; board[2][2] = 'O';
    
    printBoard();
    if (checkWin('X')) {
        cout << "X 赢了!" << endl;
    } else if (checkWin('O')) {
        cout << "O 赢了!" << endl;
    } else {
        cout << "平局!" << endl;
    }
    return 0;
}
```

> **💡 数组使用最佳实践**  
> 1. 优先使用标准库容器（如vector）代替原生数组  
> 2. 使用常量定义数组大小，避免"魔数"  
> 3. 始终检查数组索引防止越界  
> 4. 使用范围循环简化遍历（C++11）  
> 5. 传递数组时同时传递大小参数  
> 6. 复杂操作考虑封装为函数提高可读性