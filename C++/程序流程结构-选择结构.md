# C++ 选择结构知识点详解

## 📌 选择结构概述
选择结构用于根据条件执行不同的代码分支，是程序流程控制的核心组成部分。

## 🔍 1. if 语句

### (1) 单行if语句
- 语法：`if (条件) 单行语句;`
- 说明：条件为真时执行单行语句

```cpp
int score = 85;
if (score >= 60) cout << "及格了！" << endl;
```

### (2) 多行if语句
- 语法：`if (条件) { 代码块 }`
- 说明：条件为真时执行花括号内的所有语句

```cpp
int temperature = 28;
if (temperature > 30) {
    cout << "天气炎热！" << endl;
    cout << "建议减少户外活动" << endl;
}
```

### (3) if-else语句
- 语法：
  ```cpp
  if (条件) {
      // 条件为真时执行
  } else {
      // 条件为假时执行
  }
  ```

```cpp
int age = 17;
if (age >= 18) {
    cout << "您已成年，可以进入。" << endl;
} else {
    cout << "未成年禁止入内！" << endl;
}
```

### (4) 多条件if-else if语句
- 语法：
  ```cpp
  if (条件1) {
      // 条件1为真时执行
  } else if (条件2) {
      // 条件2为真时执行
  } else {
      // 所有条件都不满足时执行
  }
  ```

```cpp
int score = 85;
if (score >= 90) {
    cout << "优秀！" << endl;
} else if (score >= 80) {
    cout << "良好！" << endl;  // 会执行这一行
} else if (score >= 70) {
    cout << "中等" << endl;
} else if (score >= 60) {
    cout << "及格" << endl;
} else {
    cout << "不及格！" << endl;
}
```

### (5) 嵌套if语句
- 说明：在if语句内部包含另一个if语句

```cpp
int age = 25;
bool hasLicense = true;

if (age >= 18) {
    cout << "年龄符合要求" << endl;
    if (hasLicense) {
        cout << "允许驾驶汽车" << endl;
    } else {
        cout << "需要先考取驾照" << endl;
    }
} else {
    cout << "未达到法定驾驶年龄" << endl;
}
```

## 🔄 2. 三目运算符（条件运算符）
- 语法：`条件 ? 表达式1 : 表达式2`
- 说明：条件为真返回表达式1，否则返回表达式2

```cpp
int a = 10, b = 20;
// 找出较大值
int max = (a > b) ? a : b;

// 判断奇偶数
string result = (num % 2 == 0) ? "偶数" : "奇数";

// 嵌套三目运算符
string grade = (score >= 90) ? "A" : 
               (score >= 80) ? "B" : 
               (score >= 70) ? "C" : 
               (score >= 60) ? "D" : "E";
```

## 🔀 3. switch语句
- 语法：
  ```cpp
  switch(表达式) {
      case 值1: 
          代码块1;
          break;
      case 值2:
          代码块2;
          break;
      // ...
      default:
          默认代码块;
  }
  ```
- 特点：
  - 表达式必须是**整型或枚举类型**
  - case值必须是**常量表达式**
  - break用于跳出switch，没有break会继续执行下一个case（case穿透）

### 基础示例
```cpp
int day = 3;
switch(day) {
    case 1: 
        cout << "星期一" << endl;
        break;
    case 2:
        cout << "星期二" << endl;
        break;
    case 3:
        cout << "星期三" << endl;  // 会执行这一行
        break;
    default:
        cout << "无效输入" << endl;
}
```

### 利用case穿透特性
```cpp
char grade = 'B';
switch(grade) {
    case 'A':
    case 'a':
        cout << "优秀！" << endl;
        break;
    case 'B':
    case 'b':
        cout << "良好！" << endl;  // 会执行这一行
        break;
    case 'C':
    case 'c':
        cout << "及格" << endl;
        break;
    default:
        cout << "不及格" << endl;
}
```

### switch与if的对比
| 特点         | switch语句                     | if-else语句                  |
|--------------|-------------------------------|-----------------------------|
| 适用场景      | 多分支等值判断                 | 范围判断、复杂条件           |
| 可读性        | 分支清晰                      | 复杂条件时可能较混乱         |
| 表达式类型    | 整型、枚举类型                 | 任意布尔表达式               |
| 执行效率      | 通常更高（跳转表）             | 需要顺序判断条件             |
| 条件覆盖      | 需要显式处理所有情况           | 可使用else处理剩余情况       |

## 🚀 选择结构最佳实践

### 1. 条件判断技巧
```cpp
// 简化布尔判断
if (isValid) {...}  // 优于 if (isValid == true)

// 简化空指针检查
if (ptr) {...}      // 优于 if (ptr != nullptr)
```

### 2. 避免常见错误
```cpp
// 错误1：条件后误加分号
if (condition); {  // 分号导致空语句
    // 这个代码块总是会执行！
}

// 错误2：赋值(=)与相等(==)混淆
int x = 5;
if (x = 0) { // 总是false，且修改了x的值
    // 永远不会执行
}

// 错误3：switch中遗漏break
switch(value) {
    case 1: 
        cout << "One";
        // 缺少break!
    case 2:
        cout << "Two"; // 当value=1时会执行
        break;
}
```

### 3. 复杂条件处理
```cpp
// 检查多个条件
if (age >= 18 && hasID && !isExpired) {
    cout << "允许进入" << endl;
}

// 范围检查
if (temperature >= 30 || humidity >= 90) {
    cout << "高温高湿警告！" << endl;
}

// 使用德·摩根定律简化条件
if (!(fileExists && isReadable)) 
// 等价于：
if (!fileExists || !isReadable)
```

## 📊 选择结构应用案例

### 案例1：成绩等级转换
```cpp
int score;
cout << "请输入成绩(0-100): ";
cin >> score;

if (score < 0 || score > 100) {
    cout << "无效成绩！" << endl;
} else {
    char grade;
    if (score >= 90) grade = 'A';
    else if (score >= 80) grade = 'B';
    else if (score >= 70) grade = 'C';
    else if (score >= 60) grade = 'D';
    else grade = 'E';
    
    cout << "成绩等级: " << grade << endl;
}
```

### 案例2：计算器程序
```cpp
char op;
double num1, num2;
cout << "输入运算符 (+, -, *, /): ";
cin >> op;
cout << "输入两个操作数: ";
cin >> num1 >> num2;

switch(op) {
    case '+':
        cout << num1 << " + " << num2 << " = " << num1 + num2;
        break;
    case '-':
        cout << num1 << " - " << num2 << " = " << num1 - num2;
        break;
    case '*':
        cout << num1 << " * " << num2 << " = " << num1 * num2;
        break;
    case '/':
        if (num2 != 0.0)
            cout << num1 << " / " << num2 << " = " << num1 / num2;
        else
            cout << "错误！除数不能为零";
        break;
    default:
        cout << "无效运算符！";
}
```

### 案例3：闰年判断
```cpp
int year;
cout << "输入年份: ";
cin >> year;

// 闰年规则：能被4整除但不能被100整除，或能被400整除
bool isLeap = false;
if (year % 4 == 0) {
    if (year % 100 == 0) {
        if (year % 400 == 0) {
            isLeap = true;
        }
    } else {
        isLeap = true;
    }
}

// 使用逻辑运算符简化
bool isLeap2 = (year % 4 == 0 && year % 100 != 0) || (year % 400 == 0);

cout << year << (isLeap ? "是" : "不是") << "闰年" << endl;
```

> **💡 选择结构设计原则**  
> 1. 优先考虑可读性，避免过度复杂的嵌套  
> 2. 多分支等值判断优先使用switch语句  
> 3. 范围判断或复合条件使用if-else结构  
> 4. 简单条件赋值使用三目运算符  
> 5. 始终处理边界条件和默认情况